---
title: "Homework3"
author: "Yicong Zeng"
format: pdf
editor: visual
---

## Set up

```{r}
#| message: false
library(tidyverse)
library(readxl)
library(here)
library(janitor)
library(GGally)
library(MuMIn)
library(ggeffects)
library(gtsummary)
library(flextable)
library(modelsummary)
library(gt)
drought_exp <- read_xlsx(path = here("data", 
                                     "Valliere_etal_EcoApps_Data.xlsx"),
                         sheet = "First Harvest")
```

## Problem 1: Multiple linear regression: model selection and construction

a.  Make a table or list of all the models from class and the last one you constructed on your own. Write a caption for your table.

### Cleaning

```{r}
drought_exp_clean <- drought_exp %>% 
  clean_names() %>% # nicer column names
  mutate(species_name = case_when( # adding column with species scientific names
    species == "ENCCAL" ~ "Encelia californica", # bush sunflower
    species == "ESCCAL" ~ "Eschscholzia californica", # California poppy
    species == "PENCEN" ~ "Penstemon centranthifolius", # Scarlet bugler
    species == "GRICAM" ~ "Grindelia camporum", # great valley gumweed
    species == "SALLEU" ~ "Salvia leucophylla", # Purple sage
    species == "STIPUL" ~ "Nasella pulchra", # Purple needlegrass
    species == "LOTSCO" ~ "Acmispon glaber" # deerweed
  )) %>% 
  relocate(species_name, .after = species) %>% # moving species_name column after species
  mutate(water_treatment = case_when( # adding column with full treatment names
    water == "WW" ~ "Well watered",
    water == "DS" ~ "Drought stressed"
  )) %>% 
  relocate(water_treatment, .after = water) # moving water_treatment column after water
```

### Table

**"Table 1. List of five Models. Each column in the table represent a different linear model that used to predict the total biomass. The row of the table include different combinations of predictors: specific leaf area, water treatment, and species name. Also, the second part of table shows the statistics of each models, include R2, R2 Adj., AIC, delta AIC, etc."**

```{r}
model0 <- lm(total_g ~ 1, # formula
             data = drought_exp_clean) # data frame

model1 <- lm(total_g ~ sla + water_treatment + species_name, # formula
             data = drought_exp_clean) # data frame

model2 <- lm(total_g ~ sla + water_treatment, # formula
             data = drought_exp_clean) # data frame

model3 <- lm(total_g ~ sla + species_name, # formula
             data = drought_exp_clean) # data frame

model4 <- lm(total_g ~ water_treatment + species_name, # formula
             data = drought_exp_clean) # data frame

modelsummary::modelsummary( # this function takes a list of models
  list( 
    "null" = model0, # "model name" = model object
    "model 1" = model1,
    "model 2" = model2,
    "model 3" = model3,
    "model 4" = model4
  )
)
```

